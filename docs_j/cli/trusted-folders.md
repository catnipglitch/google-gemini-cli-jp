# 信頼できるフォルダ

信頼できるフォルダ機能は、どのプロジェクトが Gemini CLI の全機能を使用できるかを制御するセキュリティ設定です。CLI がプロジェクト固有の設定を読み込む前にフォルダを承認するよう求めることで、潜在的に悪意のあるコードが実行されるのを防ぎます。

## 機能の有効化

信頼できるフォルダ機能は**デフォルトで無効**になっています。使用するには、まず設定で有効にする必要があります。

ユーザー `settings.json` ファイルに以下を追加します。

```json
{
  "security": {
    "folderTrust": {
      "enabled": true
    }
  }
}
```

## 仕組み: 信頼ダイアログ

機能が有効になると、フォルダから Gemini CLI を初めて実行したときにダイアログが自動的に表示され、選択を促されます。

- **フォルダを信頼する**: 現在のフォルダ（例: `my-project`）に完全な信頼を付与します。
- **親フォルダを信頼する**: 親ディレクトリ（例: `safe-projects`）に信頼を付与します。これにより、そのすべてのサブディレクトリも自動的に信頼されます。これは、すべての安全なプロジェクトを1か所に保持する場合に便利です。
- **信頼しない**: フォルダを信頼できないとしてマークします。CLI は制限された「セーフモード」で動作します。

あなたの選択は中央ファイル（`~/.gemini/trustedFolders.json`）に保存されるため、フォルダごとに一度しか尋ねられません。

## 信頼が重要な理由: 信頼できないワークスペースの影響

フォルダが**信頼できない**場合、Gemini CLI はあなたを保護するために制限された「セーフモード」で実行されます。このモードでは、以下の機能が無効になります。

1.  **ワークスペース設定は無視されます**: CLI はプロジェクトから `.gemini/settings.json` ファイルを**読み込みません**。これにより、カスタムツールやその他の潜在的に危険な設定の読み込みが防止されます。

2.  **環境変数は無視されます**: CLI はプロジェクトから `.env` ファイルを**読み込みません**。

3.  **拡張機能管理が制限されます**: 拡張機能を**インストール、更新、アンインストールできません**。

4.  **ツール自動承認が無効になります**: グローバルで自動承認を有効にしている場合でも、ツールが実行される前に常に確認が求められます。

5.  **自動メモリ読み込みが無効になります**: CLI は、ローカル設定で指定されたディレクトリからファイルをコンテキストに自動的に読み込みません。

6.  **MCP サーバーは接続されません**: CLI は、[モデルコンテキストプロトコル (MCP)](../tools/mcp-server.md) サーバーへの接続を試みません。

7.  **カスタムコマンドは読み込まれません**: CLI は、プロジェクト固有およびグローバルユーザーコマンドの両方を含む、.toml ファイルからのカスタムコマンドを読み込みません。

フォルダに信頼を付与すると、そのワークスペースで Gemini CLI の全機能が利用できるようになります。

## 信頼設定の管理

決定を変更する必要がある場合や、すべての設定を確認したい場合は、いくつかのオプションがあります。

- **現在のフォルダの信頼を変更する**: CLI 内から `/permissions` コマンドを実行します。これにより、同じインタラクティブなダイアログが表示され、現在のフォルダの信頼レベルを変更できます。

- **すべての信頼ルールを表示する**: すべての信頼できるフォルダと信頼できないフォルダのルールを完全にリスト表示するには、ホームディレクトリの `~/.gemini/trustedFolders.json` ファイルの内容を検査できます。

## 信頼チェックプロセス (上級者向け)

上級ユーザー向けに、信頼がどのように決定されるかの正確な操作順序を知っておくと役立ちます。

1.  **IDE 信頼シグナル**: [IDE 統合](../ide-integration.md)を使用している場合、CLI はまず IDE にワークスペースが信頼されているかどうかを尋ねます。IDE の応答が最優先されます。

2.  **ローカル信頼ファイル**: IDE が接続されていない場合、CLI は中央の `~/.gemini/trustedFolders.json` ファイルをチェックします。